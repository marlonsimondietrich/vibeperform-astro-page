---
import Button from './Button.astro';
import Footer from './Footer.astro';
import NavBar from './NavBar.astro';
import { Lightbulb, Rocket, UserRoundCog } from 'lucide-static';
import type { WorkshopsContent } from '../data/workshopsContent';

interface Props {
	content: WorkshopsContent;
	homeHref: string;
	alternateLocaleHref: string;
	currentLocale: 'en' | 'de';
}

const { content, homeHref, alternateLocaleHref, currentLocale } = Astro.props as Props;
const { nav, hero, valueSection, offeringsIntro, offerings, scorecard, finalCta } = content;
const locale = currentLocale === 'de' ? 'de' : 'en';
const nextMovesLabel = locale === 'de' ? 'Nächste Schritte' : 'Next moves';
const [heroScenario, ...otherScenarios] = scorecard.scenarios;
const scenarioList = otherScenarios.length ? otherScenarios : scorecard.scenarios;
const heroCardTitles = ['Prompt Engineering', 'Explore Workshop', 'Design Workshop'];
const heroCardDescriptions = heroCardTitles.map((_, index) => {
	if (index === 1) {
		return locale === 'de'
			? "Wir identifizieren gemeinsam, wo in euren Arbeitsabläufen Potenzial für KI steckt. Dem Explore Workshop folgt der 'Design'-Workshop."
			: 'Together we surface where your workflows have the most AI potential. The Design Workshop follows the Explore session.';
	}
	if (index === 2) {
		return locale === 'de'
			? "Wir entwickeln ein Lösungsszenario mit KI für den priorisierten Use-Case. Dieser Workshop baut auf dem 'Explore'-Workshop auf."
			: "We design an AI-enabled solution scenario for the prioritised use case. This session builds on the Explore workshop.";
	}
	return heroScenario.description;
});
const designFocusOverrides = {
	de: ['Was brauchen die Nutzer der Lösung?', 'Wie sieht der neue Ablauf aus?', 'Wie wird Erfolg gemessen?'],
	en: ['Who uses the solution?', 'What does the new workflow look like?', 'How do we measure success?'],
} as const;
const promptFocusOverrides = {
	de: ['Was will ich erreichen?', 'Was sind die Best Practices?', 'Wie kann ich Kontext nutzen?'],
	en: ['What do I want to achieve?', 'What are the best practices?', 'How can I leverage context?'],
} as const;
const promptResultsOverrides = {
	de: [
		'Kennenlernen von verschiedenen Tools',
		'Direktes Feedback zu euren Prompts',
		'Best Practices abgestimmt auf eure Bereiche',
	],
	en: [
		'Frameworks for text, image, data, and automation prompts',
		'Instant feedback on your prompts',
		'Guides tailored to your teams and workflows',
	],
} as const;
const designResultsOverrides = {
	de: [
		'Zukünftiger Prozess mit KI-Unterstützung',
		'Feature-Set und Datenbedarf',
		'Vertrauens- und Qualitätskriterien fürs Team',
	],
	en: [
		'Future-state workflow with AI in the loop',
		'Defined feature set and data requirements',
		'Trust and quality criteria for the team',
	],
} as const;

const exploreResultsOverrides = {
	de: [
		'Übersicht über eure größten Pain Points',
		'Shortlist an KI-/Automations-Ideen',
		'Empfehlung: Womit starten und warum',
	],
	en: ['Map of current bottlenecks', 'Shortlist of AI/automation ideas', 'Recommendation on where to start and why'],
} as const;

const valueIcons = {
	lightbulb: Lightbulb,
	'user-round-cog': UserRoundCog,
	rocket: Rocket,
} as const;

const renderValueIcon = (key?: keyof typeof valueIcons | string) => {
	const iconSvg = key && key in valueIcons ? valueIcons[key as keyof typeof valueIcons] : valueIcons.lightbulb;
	return iconSvg
		.replace('class="lucide', 'class="lucide h-10 w-10')
		.replace('width="24"', 'width="40"')
		.replace('height="24"', 'height="40"');
};
---

<div class="flex min-h-screen flex-col bg-white">
	<NavBar nav={nav} homeHref={homeHref} alternateLocaleHref={alternateLocaleHref} />

	<main class="flex flex-1 flex-col gap-y-24 pb-20">
		{/* Hero */}
		<section class="section-spacing">
			<div class="container-responsive mx-auto max-w-4xl space-y-6 text-left">
				<p class="text-xs font-semibold uppercase tracking-[0.35em] text-slate-500 sm:text-sm">{hero.kicker}</p>
				<h1 class="text-4xl font-semibold tracking-tight text-slate-900 md:text-5xl">{hero.title}</h1>
				<p class="text-base text-slate-600 [text-wrap:balance] sm:text-lg md:text-xl">{hero.intro}</p>
				{hero.sub ? (
					<p class="text-sm text-slate-500 md:text-base">{hero.sub}</p>
				) : null}
				{hero.cta ? (
					<div class="flex flex-col gap-3 pt-2 sm:flex-row">
						<Button href={hero.cta.href}>{hero.cta.label}</Button>
					</div>
				) : null}
			</div>
		</section>

		{/* Hero Cards */}
		{heroScenario ? (
			<section class="section-spacing bg-slate-50">
				<div class="container-responsive space-y-8">
						<div class="space-y-3 text-left">
							<p class="text-xs font-semibold uppercase tracking-[0.35em] text-slate-500">{locale === 'de' ? 'Formate im Überblick' : 'Formats at a glance'}</p>
							<h2 class="text-3xl font-semibold text-slate-900 sm:text-4xl">{locale === 'de' ? 'Wo wir einsteigen' : 'Where we start together'}</h2>
								<p class="text-base text-slate-600 sm:text-lg">
									{locale === 'de'
										? "Auf Anfrage bieten wir deinem Team oder Unternehmen folgende zugeschnittene Workshop-formate. In die Umsetzung und Entwicklung möglicher KI-Lösungen gehen wir nach abgeschlossenem 'Design'-Workshop."
										: 'On request we deliver tailored workshop formats for your team or organisation. We only enter build mode once the Design Workshop is complete.'}
								</p>
								<p class="text-base text-slate-600 sm:text-lg">
									{locale === 'de'
										? 'Unsere Workshops bieten wir sowohl vor Ort in und um München, als auch remote an.'
										: 'We run workshops on-site in and around Munich as well as remotely.'}
								</p>
						</div>
						<div class="grid gap-6 lg:grid-cols-3">
						{heroCardTitles.map((title, index) => (
							<div class="overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-sm transition hover:-translate-y-0.5 hover:shadow-lg">
								<div class="h-48 w-full overflow-hidden bg-slate-100 sm:h-56">
									<img
										src={
											index === 0
												? '/vibeperform-astro-page/workshop1.webp'
												: index === 1
													? '/vibeperform-astro-page/workshop2.webp'
													: '/vibeperform-astro-page/workshop3.webp'
										}
										alt={title}
										class="h-full w-full object-cover"
										loading="lazy"
										decoding="async"
									/>
								</div>
								<div class="space-y-6 p-6">
										<p class="text-lg font-semibold text-slate-900">{title}</p>
										<p class="text-sm leading-relaxed text-slate-600">
												{index === 0
													? locale === 'de'
														? 'Wir machen euer Team prompt-stark – für Text, Bild, und Prozesse. Inhalte und Beispiele passen wir an euren Bereich an (Marketing, Vertrieb, HR, ...).'
														: 'We level up your team’s prompt skills across text, image, and workflows, tailoring examples to your domain.'
													: heroCardDescriptions[index] ?? heroScenario.description}
										</p>
										<div class="grid gap-2">
											{heroScenario.scoreFocus.map((focus, focusIndex) => (
												<div class="rounded-2xl border border-transparent bg-slate-50 px-3 py-2 text-sm text-slate-600">
													{index === 0
														? promptFocusOverrides[locale][focusIndex] ?? focus
														: index === 2
															? designFocusOverrides[locale][focusIndex] ?? focus
															: focus}
												</div>
											))}
										</div>
										{heroScenario.nextMoves?.length ? (
											<div class="rounded-2xl border border-purple-200 bg-purple-50 p-4 text-sm text-slate-700">
												<p class="text-xs font-semibold uppercase tracking-[0.25em] text-purple-700">
													{index === 0 || index === 1 || index === 2
														? locale === 'de'
															? 'Ergebnis'
															: 'Outcome'
														: nextMovesLabel}
												</p>
												<ul class="mt-3 space-y-2">
													{index === 0 ? (
														<>
															{promptResultsOverrides[locale].map((line) => (
																<li class="flex gap-3">
																	<span aria-hidden="true" class="mt-2 h-1.5 w-1.5 rounded-full bg-purple-500" />
																	<span>{line}</span>
																</li>
															))}
														</>
													) : index === 1 ? (
														<>
															{exploreResultsOverrides[locale].map((line) => (
																<li class="flex gap-3">
																	<span aria-hidden="true" class="mt-2 h-1.5 w-1.5 rounded-full bg-purple-500" />
																	<span>{line}</span>
																</li>
															))}
														</>
													) : index === 2 ? (
														<>
															{designResultsOverrides[locale].map((line) => (
																<li class="flex gap-3">
																	<span aria-hidden="true" class="mt-2 h-1.5 w-1.5 rounded-full bg-purple-500" />
																	<span>{line}</span>
																</li>
															))}
														</>
													) : (
														heroScenario.nextMoves.map((move) => (
															<li class="flex gap-3">
																<span aria-hidden="true" class="mt-2 h-1.5 w-1.5 rounded-full bg-purple-500" />
																<span>{move}</span>
														</li>
													))
												)}
											</ul>
										</div>
									) : null}
								</div>
							</div>
						))}
					</div>
				</div>
			</section>
			) : null}

			{/* Value Section */}
			<section class="section-spacing bg-white">
					<div class="container-responsive mx-auto max-w-5xl space-y-10">
						<div class="mx-auto max-w-3xl space-y-3 text-center">
							<p class="text-xs font-semibold uppercase tracking-[0.35em] text-slate-500">
								{locale === 'de' ? 'Mehr als Beratung' : 'More than consulting'}
							</p>
							<h2 class="text-3xl font-semibold text-slate-900 sm:text-4xl">{valueSection.heading}</h2>
						</div>

					<div class="grid gap-6 md:grid-cols-3">
						{valueSection.bullets.map((item) => (
							<article class="flex h-full flex-col rounded-3xl border border-slate-200 bg-white p-6 text-left shadow-sm transition hover:-translate-y-1 hover:shadow-lg sm:p-8">
								<div class="mb-4 inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-purple-100 text-purple-600" aria-hidden="true">
									<div set:html={renderValueIcon(item.icon)} />
								</div>
								<h3 class="text-lg font-semibold text-slate-900">{item.title}</h3>
								<p class="mt-3 text-sm leading-relaxed text-slate-600">{item.body}</p>
							</article>
						))}
					</div>
				</div>
			</section>

			{/* Final CTA */}
			<section class="section-spacing bg-slate-50">
				<div class="container-responsive">
					<div class="mx-auto max-w-3xl space-y-6 rounded-3xl bg-white p-8 text-center shadow-sm sm:p-10">
						<h2 class="text-3xl font-semibold text-slate-900 sm:text-4xl">{finalCta.heading}</h2>
						<p class="text-base text-slate-600 sm:text-lg">{finalCta.body}</p>
						<Button href={finalCta.button.href}>{finalCta.button.label}</Button>
					</div>
				</div>
			</section>
	</main>
	<Footer currentLocale={locale} />
</div>
